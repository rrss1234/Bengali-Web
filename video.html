<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Best IPTV PRO | Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        :root {
            --bg: #050505;
            --sidebar: #111111;
            --card: #1a1a1a;
            --accent: #00d2ff;
            --accent-grad: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%);
            --text: #ffffff;
            --text-dim: #a0a0a0;
            --border: #222222;
            --danger: #ff4757;
            --success: #2ed573;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        
        body { background: var(--bg); color: var(--text); height: 100vh; display: flex; overflow: hidden; }

        /* SIDEBAR */
        .sidebar { width: 280px; background: var(--sidebar); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 30px 20px; }
        .app-logo { display: flex; align-items: center; gap: 15px; margin-bottom: 40px; }
        .app-logo i { font-size: 2.2rem; color: var(--accent); }
        .app-name { font-size: 1.5rem; font-weight: 800; background: var(--accent-grad); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        .nav-menu { flex: 1; }
        .nav-item { display: flex; align-items: center; gap: 15px; padding: 14px 18px; border-radius: 12px; color: var(--text-dim); text-decoration: none; margin-bottom: 10px; cursor: pointer; transition: 0.3s; }
        .nav-item:hover, .nav-item.active { background: rgba(0, 210, 255, 0.1); color: var(--accent); }

        /* MAIN CONTENT */
        .main-container { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
        .top-bar { height: 80px; padding: 0 40px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid var(--border); }
        .search-input { width: 400px; background: var(--card); border: 1px solid var(--border); padding: 12px 20px; border-radius: 12px; color: white; outline: none; }

        .content-area { flex: 1; padding: 40px; overflow-y: auto; }
        .grid-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .playlist-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; }

        /* PLAYLIST CARD */
        .playlist-card { background: var(--card); border: 1px solid var(--border); border-radius: 20px; padding: 25px; transition: 0.3s; position: relative; }
        .playlist-card:hover { transform: translateY(-5px); border-color: var(--accent); }
        .card-top { display: flex; justify-content: space-between; margin-bottom: 15px; }
        .card-icon { width: 50px; height: 50px; background: var(--accent-grad); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; }
        
        .badge { font-size: 0.65rem; padding: 4px 10px; border-radius: 10px; font-weight: bold; text-transform: uppercase; }
        .badge-official { background: rgba(0, 210, 255, 0.1); color: var(--accent); }
        .badge-user { background: rgba(46, 213, 115, 0.1); color: var(--success); }

        .card-footer { margin-top: 20px; padding-top: 15px; border-top: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .btn-play { background: var(--accent-grad); color: white; border: none; padding: 8px 18px; border-radius: 8px; font-weight: 600; cursor: pointer; }
        
        .action-btns { display: flex; gap: 15px; color: var(--text-dim); }
        .action-btns i { cursor: pointer; transition: 0.2s; }
        .action-btns i:hover { color: var(--accent); }
        .fa-trash-alt:hover { color: var(--danger) !important; }

        /* MODAL */
        .modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.85); backdrop-filter: blur(8px); display: none; z-index: 1000; }
        .modal-content { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 450px; background: var(--card); border-radius: 20px; padding: 35px; display: none; z-index: 1001; border: 1px solid var(--border); }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 8px; color: var(--text-dim); }
        .form-input { width: 100%; background: var(--bg); border: 1px solid var(--border); padding: 12px; border-radius: 10px; color: white; outline: none; }
        .submit-btn { width: 100%; background: var(--accent-grad); color: white; border: none; padding: 12px; border-radius: 10px; font-weight: bold; cursor: pointer; margin-top: 10px; }
    </style>
</head>
<body>

    <aside class="sidebar">
        <div class="app-logo">
            <i class="fas fa-play-circle"></i>
            <div class="app-name">Best IPTV PRO</div>
        </div>
        <nav class="nav-menu">
            <div class="nav-item active"><i class="fas fa-th-large"></i> Dashboard</div>
            <div class="nav-item" onclick="openModal()"><i class="fas fa-plus-circle"></i> Add Playlist</div>
        </nav>
    </aside>

    <div class="main-container">
        <header class="top-bar">
            <input type="text" class="search-input" id="searchInput" placeholder="Search playlists...">
            <div id="pCountTop" style="color: var(--accent); font-weight: bold;">0 Playlists</div>
        </header>

        <main class="content-area">
            <div class="grid-header">
                <h1>My Library</h1>
                <button onclick="openModal()" class="submit-btn" style="width: auto; padding: 10px 20px;">+ Add New</button>
            </div>
            <div class="playlist-grid" id="playlistGrid"></div>
        </main>
    </div>

    <div class="modal-backdrop" id="backdrop" onclick="closeModal()"></div>
    <div class="modal-content" id="modal">
        <h2 id="modalTitle" style="margin-bottom: 20px;">Add New Playlist</h2>
        <form id="pForm">
            <input type="hidden" id="editId">
            <div class="form-group">
                <label>Playlist Name</label>
                <input type="text" class="form-input" id="pName" required>
            </div>
            <div class="form-group">
                <label>M3U URL</label>
                <input type="url" class="form-input" id="pUrl" required>
            </div>
            <button type="submit" class="submit-btn" id="saveBtn">Save Playlist</button>
        </form>
    </div>

    <script>
        const playlistGrid = document.getElementById('playlistGrid');
        const searchInput = document.getElementById('searchInput');
        
        const defaultServers = [
            { id: 's1', name: "Live Sports Global", url: "Sports.m3u", type: "default" },
            { id: 's2', name: "Entertainment HD", url: "All.m3u", type: "default" },
            { id: 's3', name: "International Radio", url: "FMRadio.m3u", type: "default" }
        ];

        function render(filter = '') {
            const saved = JSON.parse(localStorage.getItem('user_playlists')) || [];
            const all = [...defaultServers, ...saved];
            const filtered = all.filter(p => p.name.toLowerCase().includes(filter.toLowerCase()));
            
            playlistGrid.innerHTML = '';
            document.getElementById('pCountTop').innerText = `${filtered.length} Playlists`;

            filtered.forEach(p => {
                const isDefault = p.type === 'default';
                const card = document.createElement('div');
                card.className = 'playlist-card';
                card.innerHTML = `
                    <div class="card-top">
                        <div class="card-icon"><i class="fas fa-play"></i></div>
                        <span class="badge ${isDefault ? 'badge-official' : 'badge-user'}">${isDefault ? 'Official' : 'Personal'}</span>
                    </div>
                    <h3>${p.name}</h3>
                    <p style="font-size: 0.8rem; color: var(--text-dim); margin-top:5px;">${p.url.substring(0, 35)}...</p>
                    <div class="card-footer">
                        <button class="btn-play" onclick="location.href='video.html?playlist=${encodeURIComponent(p.url)}'">Watch</button>
                        <div class="action-btns">
                            ${!isDefault ? `
                                <i class="fas fa-edit" onclick="editItem('${p.id}')" title="Edit"></i>
                                <i class="fas fa-trash-alt" onclick="deleteItem('${p.id}')" title="Delete"></i>
                            ` : '<i class="fas fa-lock" title="Fixed"></i>'}
                        </div>
                    </div>
                `;
                playlistGrid.appendChild(card);
            });
        }

        // এডিট ফাংশন
        function editItem(id) {
            let saved = JSON.parse(localStorage.getItem('user_playlists')) || [];
            const item = saved.find(x => x.id === id);
            if(item) {
                document.getElementById('editId').value = item.id;
                document.getElementById('pName').value = item.name;
                document.getElementById('pUrl').value = item.url;
                document.getElementById('modalTitle').innerText = "Edit Playlist";
                openModal();
            }
        }

        // ডিলিট ফাংশন
        function deleteItem(id) {
            if(confirm("Are you sure you want to delete this?")) {
                let saved = JSON.parse(localStorage.getItem('user_playlists')) || [];
                saved = saved.filter(x => x.id !== id);
                localStorage.setItem('user_playlists', JSON.stringify(saved));
                render();
            }
        }

        function openModal() {
            document.getElementById('modal').style.display = 'block';
            document.getElementById('backdrop').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
            document.getElementById('backdrop').style.display = 'none';
            document.getElementById('pForm').reset();
            document.getElementById('editId').value = '';
            document.getElementById('modalTitle').innerText = "Add New Playlist";
        }

        document.getElementById('pForm').onsubmit = (e) => {
            e.preventDefault();
            const id = document.getElementById('editId').value;
            const name = document.getElementById('pName').value;
            const url = document.getElementById('pUrl').value;
            let saved = JSON.parse(localStorage.getItem('user_playlists')) || [];

            if(id) {
                // আপডেট (Update)
                const index = saved.findIndex(x => x.id === id);
                saved[index] = { ...saved[index], name, url };
            } else {
                // নতুন যোগ (Add New)
                saved.push({ id: Date.now().toString(), name, url, type: 'user' });
            }

            localStorage.setItem('user_playlists', JSON.stringify(saved));
            render();
            closeModal();
        };

        searchInput.oninput = (e) => render(e.target.value);
        render();
    </script>
</body>
</html>
